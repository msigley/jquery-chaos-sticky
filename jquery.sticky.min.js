/*
 * jQuery Chaos Sticky Elements
 * By Matthew Sigley
 * Based on work by Jonathan Davis - http://shopplugin.net
 * Version 1.0.0
 * 
 * Arguements (passed to stickyElement function as an Array):
 * - verticalPosition (positive integer) : number of pixels to offset sticky effect from top of viewport. Default - 10.
 * - relativeElement (non-empty jQuery object) : block element to position the sticky element relative to. Default - nearest ancestor block element.
 * - stickToBottom (true/false) : whether the sticky div should stop at the bottom of the parent div or not. Default - false.
 */

(function(e){e.fn.stickyElement=function(c){var a=e(this),b={width:a.width(),height:a.height(),outerWidth:a.outerWidth(),outerHeight:a.outerHeight(),"margin-bottom":a.css("margin-bottom"),"margin-top":a.css("margin-top")};"undefined"===typeof c&&(c=[]);verticalPosition="undefined"===typeof c.verticalPosition?10:c.verticalPosition;if("undefined"===typeof c.relativeElement)for(relativeElement=a.parent();"block"!=relativeElement.css("display");){if(0==relativeElement.parents().length)return this;relativeElement=
relativeElement.parent()}else relativeElement=c.relativeElement;stickToBottom="undefined"===typeof c.stickToBottom?!1:c.stickToBottom;if("number"!==typeof verticalPosition||0!==verticalPosition%1||0>verticalPosition||"undefined"===typeof relativeElement.jquery||0==relativeElement.length||"block"!=a.css("display")||"block"!=relativeElement.css("display"))return this;"1.8.0">e.fn.jquery&&0!=e.fn.jquery.indexOf("1.1.")&&(isBorderBox="border-box"===a.css("box-sizing")||"border-box"===a.css("-moz-box-sizing"))&&
(b.width=b.outerWidth,b.height=b.outerHeight);a.width(b.width);a.height(b.height);relativeElement.css({position:"relative"});a.css({"z-index":"1000"});var f=function(a){var c=e(this).scrollTop(),d=a.data.moveElement,b=a.data.initialDimensions;initialOffset=a.data.initialOffset;verticalPosition=a.data.verticalPosition;relativeElement=a.data.relativeElement;stickToBottom=a.data.stickToBottom;relativeBottom=relativeElement.offset().top+relativeElement.innerHeight();c<initialOffset.top-verticalPosition?
"static"!=d.css("position")&&(console&&console.log("returning top stuck element"),d.not(".sticky-placeholder").css({position:"static",bottom:"",top:"",left:"","margin-top":b["margin-top"],"margin-bottom":b["margin-bottom"]}),d.siblings(".sticky-placeholder").remove()):stickToBottom&&c>relativeBottom-verticalPosition-b.height?"absolute"!=d.css("position")&&(console&&console.log("sticking element to bottom of container"),d.not(".sticky-placeholder").css({position:"absolute",bottom:"0",top:"",left:"",
"margin-top":"0","margin-bottom":"0"})):"fixed"!=d.css("position")&&(console&&console.log("actually sticking element"),a=d.clone(),a.width(b.outerWidth),a.height(b.outerHeight),a.css({"box-sizing":"border-box",background:"transparent",border:"0",padding:"0",margin:"0"}),a.html(""),a.addClass("sticky-placeholder"),a.insertAfter(d),d.not(".sticky-placeholder").css({position:"fixed",bottom:"",top:verticalPosition+"px",left:"","margin-top":"0","margin-bottom":"0"}))};if(document.readyState)if("complete"==
document.readyState)e(window).on("scroll",{moveElement:a,initialDimensions:b,initialOffset:a.offset(),verticalPosition:verticalPosition,relativeElement:relativeElement,stickToBottom:stickToBottom},f);else e(window).load(function(){e(window).on("scroll",{moveElement:a,initialDimensions:b,initialOffset:a.offset(),verticalPosition:verticalPosition,relativeElement:relativeElement,stickToBottom:stickToBottom},f)});return this}})(jQuery);